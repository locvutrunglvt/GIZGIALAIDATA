<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°o c√°o Kh·∫£o s√°t N√¥ng h·ªô To√†n di·ªán - GIZ SAFE Coffee</title>
    <style>
        /* CSS IN ·∫§N CHU·∫®N A4 */
        @page {
            size: A4;
            margin: 1cm 1.5cm;
        }

        @media print {
            body {
                background: white !important;
                margin: 0;
                padding: 0;
            }

            .no-print {
                display: none !important;
            }

            .container {
                box-shadow: none !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            .page-break {
                page-break-before: always;
            }
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 11pt;
            line-height: 1.3;
            color: #333;
            background-color: #eee;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: white;
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 1.5cm 1.5cm;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }

        /* HEADER */
        .academic-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 11pt;
            line-height: 1.2;
        }

        .report-title {
            text-align: center;
            font-size: 18pt;
            font-weight: bold;
            color: #b45f06;
            margin: 15px 0;
            text-transform: uppercase;
        }

        /* TABLES */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            table-layout: fixed;
        }

        th,
        td {
            border: 1px solid black;
            padding: 5px 8px;
            vertical-align: middle;
            overflow: hidden;
            word-wrap: break-word;
        }

        th {
            background-color: #f2f2f2;
            text-align: center;
            font-size: 10pt;
        }

        .section-title {
            font-weight: bold;
            background-color: #f7e1cc;
            padding: 5px 10px;
            margin-top: 20px;
            border: 1px solid #000;
            text-transform: uppercase;
            font-size: 11pt;
        }

        .text-center {
            text-align: center;
        }

        .font-bold {
            font-weight: bold;
        }

        .italic {
            font-style: italic;
        }

        /* IMAGES */
        .respondent-img {
            max-width: 120px;
            max-height: 140px;
            border: 1px solid #ccc;
            display: none;
            margin: 5px auto;
        }

        /* TOOLBAR */
        .toolbar {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        .btn-print {
            background: #b45f06;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <div class="toolbar no-print">
        <button class="btn-print" onclick="window.print()">üñ®Ô∏è XU·∫§T B√ÅO C√ÅO (PDF)</button>
    </div>

    <div class="container">
        <!-- I. TH√îNG TIN ƒê·ªäNH DANH -->
        <div class="academic-header">
            H·ªåC VI·ªÜN N√îNG NGHI·ªÜP VI·ªÜT NAM<br>
            VI·ªÜN KINH T·∫æ V√Ä TH·ªÇ CH·∫æ N√îNG NGHI·ªÜP<br>
        </div>

        <div class="report-title">B·∫¢NG H·ªéI H·ªò N√îNG D√ÇN</div>

        <table>
            <tr>
                <td width="30">1</td>
                <td width="150">Ng√†y ph·ªèng v·∫•n</td>
                <td id="Interview_Date">...</td>
                <td width="150" rowspan="6" class="text-center">
                    <img id="Respondent_Image" class="respondent-img" src="">
                    <div id="no-photo" style="font-size: 9pt; color: #999;">·∫¢nh ƒë·ªëi t∆∞·ª£ng</div>
                </td>
            </tr>
            <tr>
                <td>2</td>
                <td>T·ªânh/Huy·ªán</td>
                <td id="Location_Admin">Gia Lai</td>
            </tr>
            <tr>
                <td>4</td>
                <td>X√£</td>
                <td id="Commune">...</td>
            </tr>
            <tr>
                <td>5</td>
                <td>Th√¥n</td>
                <td id="Village">...</td>
            </tr>
            <tr>
                <td>6</td>
                <td>T√™n ch·ªß h·ªô</td>
                <td id="Owner_Name" class="font-bold">...</td>
            </tr>
            <tr>
                <td>7</td>
                <td>S·ªë ƒëi·ªán tho·∫°i</td>
                <td id="Phone_Number">...</td>
            </tr>
        </table>

        <!-- A. TH√îNG TIN TH√ÄNH VI√äN & THU NH·∫¨P -->
        <div class="section-title">A. TH√îNG TIN TH√ÄNH VI√äN & THU NH·∫¨P</div>
        <table>
            <tr>
                <th width="30">STT</th>
                <th>Ch·ªâ ti√™u kh·∫£o s√°t</th>
                <th width="150">Gi√° tr·ªã / K·∫øt qu·∫£</th>
            </tr>
            <tr>
                <td class="text-center">1</td>
                <td>T·ªïng s·ªë nh√¢n kh·∫©u trong h·ªô</td>
                <td id="Household_Size" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">2</td>
                <td>S·ªë lao ƒë·ªông n√¥ng nghi·ªáp ch√≠nh</td>
                <td id="Farm_Labor_Count" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">3</td>
                <td>T·ªïng thu nh·∫≠p h·ªô gia ƒë√¨nh (tri·ªáu ƒë·ªìng/nƒÉm)</td>
                <td id="Total_Net_Income" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">4</td>
                <td>Thu nh·∫≠p t·ª´ c√¢y C√† ph√™ (tri·ªáu ƒë·ªìng/nƒÉm)</td>
                <td id="Coffee_Income" class="text-center">...</td>
            </tr>
        </table>

        <!-- B. TH√îNG TIN ƒê·∫§T ƒêAI & V∆Ø·ªúN C√ÇY -->
        <div class="section-title">B. TH√îNG TIN ƒê·∫§T ƒêAI & V∆Ø·ªúN C√ÇY</div>
        <table id="table-plots">
            <thead>
                <tr>
                    <th width="40">M·∫£nh</th>
                    <th>Di·ªán t√≠ch (ha)</th>
                    <th>S·ªë c√¢y</th>
                    <th>NƒÉm tr·ªìng</th>
                    <th>Gi·ªëng c√¢y</th>
                    <th>S·∫£n l∆∞·ª£ng d·ª± ki·∫øn</th>
                </tr>
            </thead>
            <tbody id="Plot_Data_Body">
                <tr>
                    <td colspan="6" class="text-center italic">ƒêang t·∫£i d·ªØ li·ªáu v∆∞·ªùn...</td>
                </tr>
            </tbody>
        </table>

        <!-- C. QU·∫¢N L√ù ƒê·∫¶U V√ÄO (V·∫¨T T∆Ø N√îNG NGHI·ªÜP) -->
        <div class="section-title">C. QU·∫¢N L√ù ƒê·∫¶U V√ÄO (PH√ÇN B√ìN & THU·ªêC BVTV)</div>
        <table>
            <tr>
                <th width="30">STT</th>
                <th>Lo·∫°i v·∫≠t t∆∞ / C√¢u h·ªèi</th>
                <th width="200">Chi ti·∫øt s·ª≠ d·ª•ng</th>
            </tr>
            <tr>
                <td class="text-center">1</td>
                <td>C√≥ s·ª≠ d·ª•ng ph√¢n b√≥n h·ªØu c∆°/vi sinh kh√¥ng?</td>
                <td id="Use_Organic_Fertilizer" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">2</td>
                <td>L∆∞·ª£ng ph√¢n h√≥a h·ªçc s·ª≠ d·ª•ng (kg/ha/nƒÉm)</td>
                <td id="Chemical_Fertilizer_Qty" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">3</td>
                <td>S·ªë l·∫ßn phun thu·ªëc BVTV trung b√¨nh/nƒÉm</td>
                <td id="Pesticide_Spray_Count" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">4</td>
                <td>Ng∆∞·ªùi phun thu·ªëc c√≥ m·∫∑c ƒë·ªì b·∫£o h·ªô kh√¥ng?</td>
                <td id="Safety_Equipment_Used" class="text-center">...</td>
            </tr>
        </table>

        <!-- D. TH·ª∞C H√ÄNH CANH T√ÅC & B·ªÄN V·ªÆNG -->
        <div class="section-title">D. TH·ª∞C H√ÄNH CANH T√ÅC & B·ªÄN V·ªÆNG</div>
        <table>
            <tr>
                <td width="50%">Th·ª±c h√†nh tr·ªìng c√¢y che b√≥ng ( Shade trees)</td>
                <td id="Shade_Trees_Practice">...</td>
            </tr>
            <tr>
                <td>Ph∆∞∆°ng ph√°p t∆∞·ªõi (T∆∞·ªõi g·ªëc/T∆∞·ªõi ti·∫øt ki·ªám)</td>
                <td id="Irrigation_Method">...</td>
            </tr>
            <tr>
                <td>Th·ª±c hi·ªán c·∫Øt t·ªâa c√†nh ƒë·ªãnh k·ª≥ (Pruning)</td>
                <td id="Pruning_Practice">...</td>
            </tr>
            <tr>
                <td>Qu·∫£n l√Ω c·ªè d·∫°i (Ph√°t c·ªè/Phun thu·ªëc)</td>
                <td id="Weed_Management">...</td>
            </tr>
        </table>

        <div class="page-break"></div> <!-- Ng·∫Øt trang ƒë·ªÉ sang trang 2 n·∫øu c·∫ßn -->

        <!-- E. BI·∫æN ƒê·ªîI KH√ç H·∫¨U & NH√Ä K√çNH (GHG) -->
        <div class="section-title">E. BI·∫æN ƒê·ªîI KH√ç H·∫¨U & NH√Ä K√çNH (GHG)</div>
        <table>
            <tr>
                <td width="30">1</td>
                <td>Th·ªùi ti·∫øt thay ƒë·ªïi c√≥ ·∫£nh h∆∞·ªüng ƒë·∫øn nƒÉng su·∫•t kh√¥ng?</td>
                <td id="Climate_Impact_Status">...</td>
            </tr>
            <tr>
                <td>2</td>
                <td>C√°c bi·ªán ph√°p ·ª©ng ph√≥ v·ªõi h·∫°n h√°n/s∆∞∆°ng mu·ªëi</td>
                <td id="Climate_Mitigation_Actions">...</td>
            </tr>
            <tr>
                <td>3</td>
                <td>C√≥ tham gia c√°c ch∆∞∆°ng tr√¨nh gi·∫£m ph√°t th·∫£i (Carbon)?</td>
                <td id="Carbon_Program_Status">...</td>
            </tr>
        </table>

        <!-- F. CH·ª®NG NH·∫¨N & TH·ªä TR∆Ø·ªúNG -->
        <div class="section-title">F. CH·ª®NG NH·∫¨N & TH·ªä TR∆Ø·ªúNG</div>
        <table>
            <tr>
                <th width="30">STT</th>
                <th>Ch·ª©ng nh·∫≠n / K√™nh ti√™u th·ª•</th>
                <th width="200">Th√¥ng tin chi ti·∫øt</th>
            </tr>
            <tr>
                <td class="text-center">1</td>
                <td>C√°c lo·∫°i ch·ª©ng nh·∫≠n ƒëang √°p d·ª•ng (4C, RA, Organic...)</td>
                <td id="Certifications_List" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">2</td>
                <td>K√™nh ti√™u th·ª• ch√≠nh (ƒê·∫°i l√Ω/H·ª£p t√°c x√£/C√¥ng ty)</td>
                <td id="Market_Channel" class="text-center">...</td>
            </tr>
            <tr>
                <td class="text-center">3</td>
                <td>Gi√° b√°n trung b√¨nh ni√™n v·ª• v·ª´a qua (VNƒê/kg)</td>
                <td id="Average_Selling_Price" class="text-center">...</td>
            </tr>
        </table>

        <!-- G. X√É H·ªòI, GI·ªöI & LAO ƒê·ªòNG -->
        <div class="section-title">G. X√É H·ªòI, GI·ªöI & LAO ƒê·ªòNG</div>
        <table>
            <tr>
                <td>Ai l√† ng∆∞·ªùi ra quy·∫øt ƒë·ªãnh ch√≠nh trong s·∫£n xu·∫•t?</td>
                <td id="Main_Decision_Maker">...</td>
            </tr>
            <tr>
                <td>C√≥ s·ª≠ d·ª•ng lao ƒë·ªông tr·∫ª em d∆∞·ªõi 15 tu·ªïi kh√¥ng?</td>
                <td id="Child_Labor_Status" class="font-bold">...</td>
            </tr>
            <tr>
                <td>Kho·∫£ng c√°ch t·ª´ nh√† ƒë·∫øn tr∆∞·ªùng h·ªçc/tr·∫°m y t·∫ø (km)</td>
                <td id="Social_Services_Distance">...</td>
            </tr>
        </table>

        <!-- H. ƒê√ÄO T·∫†O & KI·∫æN NGH·ªä -->
        <div class="section-title">H. ƒê√ÄO T·∫†O & KI·∫æN NGH·ªä</div>
        <table>
            <tr height="60">
                <td valign="top"><b>Nhu c·∫ßu ƒë√†o t·∫°o mong mu·ªën:</b> <br> <span id="Training_Needs">...</span></td>
            </tr>
            <tr height="60">
                <td valign="top"><b>Ki·∫øn ngh·ªã c·ªßa h·ªô n√¥ng d√¢n v·ªõi d·ª± √°n:</b> <br> <span
                        id="Farmer_Suggestions">...</span></td>
            </tr>
        </table>

        <!-- CH·ªÆ K√ù X√ÅC NH·∫¨N -->
        <div style="margin-top: 40px; display: flex; justify-content: space-between;">
            <div style="text-align: center; width: 40%;">
                <p class="font-bold">ƒê·∫†I DI·ªÜN H·ªò GIA ƒê√åNH</p>
                <br><br><br>
                <p>(K√Ω v√† ghi r√µ h·ªç t√™n)</p>
            </div>
            <div style="text-align: center; width: 40%;">
                <p class="font-bold">ƒêI·ªÄU TRA VI√äN</p>
                <br><br><br>
                <p id="Staff_Name">(K√Ω v√† ghi r√µ h·ªç t√™n)</p>
            </div>
        </div>

        <div style="margin-top: 30px; text-align: center; font-size: 9pt; color: #777; font-style: italic;">
            B√°o c√°o ƒë∆∞·ª£c tr√≠ch xu·∫•t t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng gi√°m s√°t GIZ SAFE Coffee @ 2026.
        </div>
    </div>

    <script>
        function initReport() {
            const params = new URLSearchParams(window.location.search);

            // 1. √Ånh x·∫° d·ªØ li·ªáu ƒë∆°n l·∫ª (Duy·ªát qua t·∫•t c·∫£ ID c√≥ trong Document)
            const allElements = document.querySelectorAll('[id]');
            allElements.forEach(el => {
                const value = params.get(el.id);
                if (value !== null && value !== '') {
                    if (el.tagName === 'IMG') {
                        el.src = value;
                        el.style.display = 'block';
                        if (el.id === 'Respondent_Image') document.getElementById('no-photo').style.display = 'none';
                    } else {
                        el.innerText = value;
                    }
                }
            });

            // 2. √Ånh x·∫° d·ªØ li·ªáu b·∫£ng (Plots)
            const plotsRaw = params.get('Plots');
            if (plotsRaw) {
                try {
                    const plots = JSON.parse(plotsRaw);
                    const tbody = document.getElementById('Plot_Data_Body');
                    if (plots && plots.length > 0) {
                        tbody.innerHTML = '';
                        plots.forEach(p => {
                            tbody.innerHTML += `
                                <tr>
                                    <td class="text-center">${p.TT || ''}</td>
                                    <td class="text-center">${p.Area || ''}</td>
                                    <td class="text-center">${p.Trees || ''}</td>
                                    <td class="text-center">${p.Year || ''}</td>
                                    <td class="text-center">${p.Variety || ''}</td>
                                    <td class="text-center">${p.Yield || ''}</td>
                                </tr>`;
                        });
                    }
                } catch (e) { console.error("Error parsing plots data", e); }
            }
        }
        window.onload = initReport;
    </script>
</body>

</html>
